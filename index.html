<!DOCTYPE html>
<html>
<head>
    <meta
        http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'nonce-abc123' 'nonce-def456'; style-src 'self' 'unsafe-inline'; img-src 'self' data:"
    />

    <title>CGMSIM runner</title>

    <style>
        body {
            background-color: #000;
            color: #00ff00;
            font-family: monospace;
            padding: 10px;
        }

        .switch-label-dark {
            display: none; /* Hide the "dark" label by default */
        }
    </style>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="./src/style-short.css" />

    <!-- Custom Stylesheet -->
    <!-- <link rel="stylesheet" type="text/css" href="./src/style.css" /> -->
</head>

<body>
    <!--header-->
    <h2 class="main-title">CGMSIM v.3 Runner</h2>

    <!--main section-->
    <section class="bg-texture hero">
        <!-- Console -->
        <div class="console" id="console">
            <div class="row console-row">
                <div class="col-md-8">Welcome to the CGMSIM Console</div>
                <div class="col-md-4 custom-control custom-switch">
                    <input
                        type="checkbox"
                        class="custom-control-input"
                        id="themeSwitch"
                    />
                    <label class="custom-control-label" for="themeSwitch">
                        <span class="switch-label-light">switch to Dark mode</span>
                        <span class="switch-label-dark">switch to Light mode</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- You can also require other files to run in this process -->
        <script nonce="abc123" src="./src/renderer.js"></script>
    </section>

    <script nonce="def456">
        const themeSwitch = document.getElementById('themeSwitch');

        // Check local storage for saved theme preference
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-theme');
            themeSwitch.checked = true;
            setDarkModeStyles();
            // Change the label text when in dark mode
            document.querySelector('.switch-label-dark').style.display = 'inline-block';
            document.querySelector('.switch-label-light').style.display = 'none';
        } else {
            // Set default to light mode
            document.querySelector('.switch-label-dark').style.display = 'none';
            document.querySelector('.switch-label-light').style.display = 'inline-block';
        }

        // Event listener for the theme switch
        themeSwitch.addEventListener('change', () => {
            if (themeSwitch.checked) {
                document.body.classList.add('dark-theme');
                localStorage.setItem('theme', 'dark');
                setDarkModeStyles();
                // Change the label text when switching to dark mode
                document.querySelector('.switch-label-dark').style.display = 'inline-block';
                document.querySelector('.switch-label-light').style.display = 'none';
            } else {
                document.body.classList.remove('dark-theme');
                localStorage.setItem('theme', 'light');
                resetDarkModeStyles();
                // Change the label text when switching to light mode
                document.querySelector('.switch-label-dark').style.display = 'none';
                document.querySelector('.switch-label-light').style.display = 'inline-block';
            }
        });

        // Function to set dark mode styles
        function setDarkModeStyles() {
            document.querySelector('.bg-texture').style.background =
                'linear-gradient(-45deg, #333 33%, transparent 0), linear-gradient(-45deg, #1a1a1a 100%, transparent 0)';
            document.querySelector('.console').style.backgroundColor = '#000';
            document.querySelector('.console').style.border = '1px solid #00ff00'; // Green border
            document.body.style.fontFamily = 'Cascadia Code, sans-serif'; // Set font to Cascadia Code
        }

        // Function to reset dark mode styles
        function resetDarkModeStyles() {
            document.querySelector('.bg-texture').style.background =
                'linear-gradient(-45deg, var(--background-color2) 33%, transparent 0), linear-gradient(-45deg, var(--background-color1) 100%, transparent 0)';
            document.querySelector('.console').style.backgroundColor =
                'var(--light)';
            document.querySelector('.console').style.border = '1px solid #ffffff'; // Reset border
            document.body.style.fontFamily = 'Cascadia Code, sans-serif'; // Set font to Cascadia Code
        }
    </script>
</body>
</html>
